const express=require('express'); const router=express.Router(); const db=require('../db'); let cart=[]; router.get('/',(req,res)=>{ const items=cart.map(it=>{ const p=db.prepare('SELECT * FROM products WHERE id=?').get(it.productId); return {...it, product: p}; }); res.json(items); }); router.post('/',(req,res)=>{ const {productId, qty} = req.body; const ex=cart.find(c=>c.productId===productId); if(ex) ex.qty+=qty; else cart.push({productId, qty}); res.json({ok:true, cart}); }); router.post('/clear',(req,res)=>{ cart=[]; res.json({ok:true}); }); module.exports=router;
